## homework 5

### 1. 描述交易的结构，生命周期

#### 结构：

| 属性 | 名称 | 描述 |
| :--: | :--: | :--: |
| Type | 交易类型 | - |
| Version | 版本号 | 固定为 0 或者 1 |
| Attributes | 交易属性 | 额外的属性 |
| Inputs | 交易输入 | 未花费的输出 |
| Outputs | 交易输出 | 收款方 |
| Witness | 见证人 | 验证交易时，需要此脚本 |

#### 生命周期：

1. 交易创建：准备好输入输出等事项，创建一笔完整的交易数据
1. 交易签名：钱包进行交易签名
1. 交易验证：节点收到交易请求后，进行合法验证、脚本验证
1. 交易广播：钱包所在的全节点进行交易广播，扩散整个网络
1. 交易打包：共识节点进行一定程度过滤之后，将交易打包入新区块，等待节点共识完成
1. 交易处理：节点收到新块，对交易进行一些处理，更新各自的本地文件

---

### 2. 描述区块的结构，与生命周期

区块分为两部分：区块头和区块体

#### 区块头的结构：

| 属性 | 名称 | 描述 |
| :--: | :--: | :--: |
| Version | 类型 | - |
| PrevHash | - | 前一个区块的 Hash |
| MerkleRoot | - | - |
| Timestamp | 时间戳 | - |
| Index | 索引 | 就是区块高度，从 0 开始计数 |
| ConsensusData | 随机数 | - |
| NextConsensus | - | 下一轮共识节点合约地址，锁定参与下一个区块的共识节点 |
| 1 | 见证人 | 验证交易时，需要此脚本 |
| Witness | 见证人 | 区块验证脚本 |

#### 区块体的结构：

| 属性 | 名称 | 描述 |
| :--: | :--: | :-- |
| Txs.length | 交易数量 | - |
| MinerTx | 挖矿交易 | - |
| Tx1-TxN | 交易列表 | 最多500笔，最多20笔低优先级交易。第一笔必为MinerTX，网络费给议长 |

#### 生命周期

1. 创建区块：共识节点的议长，将内存池交易进排序和过滤，打包成提案块
1. 区块共识：共识节点对提案块进行投票，当超过2/3的节点同意时，则提案通过，构建完整的区块，包括签名与交易
1. 广播区块：提案通过后，共识节点开始对提案块，附上签名，构建成完整的区块，并进行P2P广播
1. 区块校验：节点收到区块后，会先对区块进行验证，再处理和转发
1. 区块处理：节点收到新块后，对每一笔交易进行处理，并更新各自节点的账本

---

### 3. 描述NEO是如何指定当前共识节点

分为两种：链上治理申请、链下治理申请

#### 链上：

1. 申请人准备好官网、服务器等硬性条件
1. 主网参选，成为候选人，等待被投票
1. 测试并正式进行网络升级

#### 链下：

1. 申请人准备好官网、服务器等硬性条件
1. 成为合作伙伴
1. 主网参选，成为候选人，等待被投票
1. 测试并正式进行网络升级

---

### 4. 对比 UTXO类型的交易，与合约交易的优劣

#### UTXO 交易：

优势：

1. 不需要手续费
1. 操作方便

劣势：

1. 限制性较强，基本上是最普通的转账交易

#### 合约交易：

优势：

1. 交易灵活
1. 根绝合约代码可以实现多种实用的交易手段
1. 可以随自己的意愿控制交易

劣势：

1. 网络费用较高
1. 操作难度大，容易出错