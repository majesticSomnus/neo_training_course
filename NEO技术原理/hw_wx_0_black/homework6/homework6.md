
# homework 6

##1. 描述NEO的共识过程，如何出新区块

   DBFT算法的大致原理是这样的。参与记账的是超级节点，普通节点可以看到共识过程并同步账本信息，但是不参与记账。N个超级节点分为1个议长和n-1个议员，议长会轮流当选，每次记账时，先由议长发起区块提案，也就是记账的区块内容。一旦有2/3以上的记账节点同意了这个提案，那么这个提案就会成为最终发布的区块。
   
过程如下：

####1.Neo持有者投票选择共识节点，也就是议员。
####2.系统会根据议员的地址哈希做个排序，第一位为议长。以后轮值
####3.议长从交易池中拿出交易打包，并根据当前投票情况计算下一轮的共识节点,这一步打包出的是提案块
####4.议长打包出提案块后，发给所有议员，议员接收到提案块后，会对提案块进行验证。
####5.议员验证通过后，对提案块签名，并广播出去。
####6.如果有2/3的议员对该提案签名通过后，代表这个提案块通过。则出正式块.
   
以上就是出块流程.




---
##2. 描述NEO的投票规则，如何确定共识节点数，和具体的共识节点


####1.Neo持有者发一个StateTx交易进行投票，和申请成为共识节点,这些投票情况会被记录下来
####2.议长根据这些投票情况确定节点个数N。N的确定方式是有一个公式的，简单的描述是去掉过大票数和过小票数的节点，取中间投票数的中间值。这样做的目的是防止有人作恶。具体算法，拿到当前累加的票数/总票数得到所有节点的概率分布图,然后选择概率在0.25到0.75之间的期望值E，最后和备用节点个数相比取最大值。做为共识节点个数N.
####3.选取投票排名前N位，做为这些投票的共识节点.

